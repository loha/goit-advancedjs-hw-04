{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '47642330-01773e177615e156ed5ec02c5';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nconst searchPixabayImages = async (query, page = 1, perPage = 20) => {\n  try {\n    const response = await axios.get('/', {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: page,\n        per_page: perPage,\n      },\n    });\n\n    return response.data;\n  } catch (error) {\n    console.error(error);\n  }\n};\n\nexport { searchPixabayImages };\n","const createImage = image => {\n  return `\n        <li class=\"image-card\">\n            <a href=\"${image.largeImageURL}\" target=\"_blank\">\n                <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" />\n                <div class=\"image-info\">\n                    <p><b>Likes</b> ${image.likes}</p>\n                    <p><b>Views</b> ${image.views}</p>\n                    <p><b>Comments</b> ${image.comments}</p>\n                    <p><b>Downloads</b> ${image.downloads}</p>\n                </div>\n            </a>\n        </li>\n    `;\n};\n\nconst createGallery = images => {\n  const gallery = document.querySelector('.gallery');\n  gallery.innerHTML = '';\n  const html = images.map(createImage).join('');\n  gallery.insertAdjacentHTML('beforeend', html);\n};\n\nconst renderMoreImages = images => {\n  const gallery = document.querySelector('.gallery');\n  const html = images.map(createImage).join('');\n  gallery.insertAdjacentHTML('beforeend', html);\n};\n\nexport { createGallery, renderMoreImages };\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport { searchPixabayImages } from './js/pixabay-api.js';\nimport { createGallery, renderMoreImages } from './js/render-functions.js';\n\nconst searchBarForm = document.querySelector('#search-bar-form');\nconst loader = document.querySelector('body > .loader');\nconst loadMoreImagesBtn = document.querySelector('#btn-load-more');\nconst loadMoreLoader = document.querySelector('.load-more-block .loader');\nlet page = 1;\nlet perPage = 15;\nlet lightbox;\nlet seachValue;\n\nconst toggleElement = (element, className, isActive) => {\n  element.classList.toggle(className, isActive);\n};\n\nconst hasNotFoundImages = data => {\n  return !data.hits || !data.hits.length;\n};\n\nconst hasMoreImages = (page, perPage, totalHits) => {\n  return page * perPage < totalHits;\n};\n\nconst showToastMessage = (type, message) => {\n  iziToast[type]({\n    message,\n    position: 'topRight',\n  });\n};\n\nconst scrollDown = () => {\n  const imageCard = document.querySelector('.image-card');\n  const { height } = imageCard.getBoundingClientRect();\n  window.scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n};\n\nconst handleSearch = async event => {\n  event.preventDefault();\n\n  try {\n    const form = event.target;\n    seachValue = form.elements.search.value;\n\n    if (seachValue.trim().length === 0) {\n      return;\n    }\n\n    toggleElement(loadMoreImagesBtn, 'show', false);\n    toggleElement(loader, 'is-active', true);\n    page = 1;\n    const data = await searchPixabayImages(seachValue, page, perPage);\n\n    if (hasNotFoundImages(data)) {\n      showToastMessage(\n        'error',\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n    }\n\n    createGallery(data.hits);\n\n    if (hasMoreImages(page, perPage, data.totalHits)) {\n      toggleElement(loadMoreImagesBtn, 'show', true);\n    }\n\n    lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n    lightbox.refresh();\n  } catch (error) {\n    console.error(error);\n    showToastMessage('error', error.message);\n  } finally {\n    toggleElement(loader, 'is-active', false);\n  }\n};\n\nconst handleLoadMoreImages = async event => {\n  try {\n    if (!seachValue || seachValue.trim().length === 0) {\n      return;\n    }\n\n    page += 1;\n    toggleElement(loadMoreImagesBtn, 'show', false);\n    toggleElement(loadMoreLoader, 'is-active', true);\n    const data = await searchPixabayImages(seachValue, page, perPage);\n\n    if (hasNotFoundImages(data)) {\n      showToastMessage(\n        'error',\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n    }\n\n    renderMoreImages(data.hits);\n    scrollDown();\n\n    if (hasMoreImages(page, perPage, data.totalHits)) {\n      toggleElement(loadMoreImagesBtn, 'show', true);\n    } else {\n      showToastMessage(\n        'info',\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n    }\n\n    lightbox.refresh();\n  } catch (error) {\n    console.error(error);\n    showToastMessage('error', error.message);\n  } finally {\n    toggleElement(loadMoreLoader, 'is-active', false);\n  }\n};\n\nsearchBarForm.addEventListener('submit', handleSearch);\nloadMoreImagesBtn.addEventListener('click', handleLoadMoreImages);\n"],"names":["API_KEY","axios","searchPixabayImages","query","page","perPage","error","createImage","image","createGallery","images","gallery","html","renderMoreImages","searchBarForm","loader","loadMoreImagesBtn","loadMoreLoader","lightbox","seachValue","toggleElement","element","className","isActive","hasNotFoundImages","data","hasMoreImages","totalHits","showToastMessage","type","message","iziToast","scrollDown","imageCard","height","handleSearch","event","SimpleLightbox","handleLoadMoreImages"],"mappings":"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"}